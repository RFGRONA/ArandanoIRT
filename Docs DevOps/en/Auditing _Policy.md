# Database Auditing Policy v1.0

* **Project:** Arandano IRT - Water Stress Monitoring System
* **Version:** 1.0
* **Date:** 2025-06-18

### 1. Purpose
This policy defines the guidelines for auditing the project's PostgreSQL database. The primary goals are to ensure data integrity, detect unauthorized activities, and maintain compliance with industry best practices and applicable regulatory frameworks, such as the Colombian Law 1581 of 2012 (Habeas Data).

### 2. Scope
This policy applies to the PostgreSQL database operating in the **Production environment**, hosted on Oracle Cloud Infrastructure (OCI). The Staging and Local Development environments are excluded from this formal auditing policy.

### 3. Auditing Tool & Configuration
* **Tool:** The official PostgreSQL extension **`pgaudit`** will be used for all audit logging.
* **Configuration:** `pgaudit` will be configured to log the following classes of operations to capture all critical events:
    * **`DDL`**: To audit all Data Definition Language commands (e.g., `CREATE`, `ALTER`, `DROP TABLE`).
    * **`ROLE`**: To audit all changes related to roles and permissions (e.g., `GRANT`, `REVOKE`).
    * **`WRITE`**: To audit data modification operations (e.g., `INSERT`, `UPDATE`, `DELETE`).

### 4. Log Storage and Retention
* **Storage Destination:** All audit logs generated by `pgaudit` will be captured by the **OCI Unified Monitoring Agent** and securely streamed to the **OCI Logging** service. This ensures that logs are stored off-server in an immutable, centralized location.
* **Retention Period:** An immutable retention policy of **24 months** will be enforced for all audit logs stored in OCI Logging to meet compliance and forensic analysis requirements.

### 5. End-to-End User Traceability
To link a database operation to a specific end-user, the .NET application will set a session variable before executing transactions that require auditing.
* **Mechanism:** The application will execute the command `SET application_name = 'user_id:<USER_ID>'`.
* **Result:** The `application_name` variable, containing the user's unique ID, will be captured by `pgaudit` in the log entry, providing a complete and unambiguous audit trail from the web interface to the database record.

### 6. Policy Review
This policy will be reviewed annually or whenever a significant change occurs in the system architecture or regulatory requirements.