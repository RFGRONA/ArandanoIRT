<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="597px" preserveAspectRatio="none" style="width:1166px;height:597px;background:#FFFFFF;" version="1.1" viewBox="0 0 1166 597" width="1166px" zoomAndPan="magnify"><title>6.4: Flujo de Generaci칩n de Reportes PDF</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="329.6904" x="417.6362" y="27.9951">6.4: Flujo de Generaci칩n de Reportes PDF</text><g><title>AnalyticsController</title><rect fill="#FFFFFF" height="333.4609" style="stroke:#181818;stroke-width:1;" width="10" x="323.7075" y="164.8594"/></g><g><title>IPdfGeneratorService</title><rect fill="#FFFFFF" height="275.1953" style="stroke:#181818;stroke-width:1;" width="10" x="594.9595" y="193.9922"/></g><g><title>DbContext</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="880.9824" y="223.125"/></g><g><title>GraphGenerator</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="999.3799" y="323.5234"/></g><g><title>QuestPDF</title><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1114.6807" y="381.7891"/></g><g><title>Usuario</title><rect fill="#000000" fill-opacity="0.00000" height="397.7266" width="8" x="30.6021" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="34" x2="34" y1="118.5938" y2="516.3203"/></g><g><title>AnalyticsController</title><rect fill="#000000" fill-opacity="0.00000" height="397.7266" width="8" x="324.7075" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="328.334" x2="328.334" y1="118.5938" y2="516.3203"/></g><g><title>IPdfGeneratorService</title><rect fill="#000000" fill-opacity="0.00000" height="397.7266" width="8" x="595.9595" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="599.3486" x2="599.3486" y1="118.5938" y2="516.3203"/></g><g><title>DbContext</title><rect fill="#000000" fill-opacity="0.00000" height="397.7266" width="8" x="881.9824" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="885.6035" x2="885.6035" y1="118.5938" y2="516.3203"/></g><g><title>GraphGenerator</title><rect fill="#000000" fill-opacity="0.00000" height="397.7266" width="8" x="1000.3799" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1004.3613" x2="1004.3613" y1="118.5938" y2="516.3203"/></g><g><title>QuestPDF</title><rect fill="#000000" fill-opacity="0.00000" height="397.7266" width="8" x="1115.6807" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1119.3984" x2="1119.3984" y1="118.5938" y2="516.3203"/></g><g class="participant participant-head" data-participant="U"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.2041" x="5" y="115.292">Usuario</text><ellipse cx="34.6021" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M34.6021,58.7969 L34.6021,85.7969 M21.6021,66.7969 L47.6021,66.7969 M34.6021,85.7969 L21.6021,100.7969 M34.6021,85.7969 L47.6021,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="U"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.2041" x="5" y="528.3154">Usuario</text><ellipse cx="34.6021" cy="540.1172" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M34.6021,548.1172 L34.6021,575.1172 M21.6021,556.1172 L47.6021,556.1172 M34.6021,575.1172 L21.6021,590.1172 M34.6021,575.1172 L47.6021,590.1172" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="Ctrl"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.7471" x="255.334" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.7471" x="262.334" y="107.292">AnalyticsController</text></g><g class="participant participant-tail" data-participant="Ctrl"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146.7471" x="255.334" y="515.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.7471" x="262.334" y="535.3154">AnalyticsController</text></g><g class="participant participant-head" data-participant="PdfSvc"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.2217" x="518.3486" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.2217" x="525.3486" y="107.292">IPdfGeneratorService</text></g><g class="participant participant-tail" data-participant="PdfSvc"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="163.2217" x="518.3486" y="515.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="149.2217" x="525.3486" y="535.3154">IPdfGeneratorService</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.7578" x="841.6035" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.7578" x="848.6035" y="107.292">DbContext</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.7578" x="841.6035" y="515.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.7578" x="848.6035" y="535.3154">DbContext</text></g><g class="participant participant-head" data-participant="GraphGen"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128.0371" x="940.3613" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.0371" x="947.3613" y="107.292">GraphGenerator</text></g><g class="participant participant-tail" data-participant="GraphGen"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128.0371" x="940.3613" y="515.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.0371" x="947.3613" y="535.3154">GraphGenerator</text></g><g class="participant participant-head" data-participant="QuestPdf"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.5645" x="1078.3984" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.5645" x="1085.3984" y="107.292">QuestPDF</text></g><g class="participant participant-tail" data-participant="QuestPdf"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82.5645" x="1078.3984" y="515.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68.5645" x="1085.3984" y="535.3154">QuestPDF</text></g><g><title>AnalyticsController</title><rect fill="#FFFFFF" height="333.4609" style="stroke:#181818;stroke-width:1;" width="10" x="323.7075" y="164.8594"/></g><g><title>IPdfGeneratorService</title><rect fill="#FFFFFF" height="275.1953" style="stroke:#181818;stroke-width:1;" width="10" x="594.9595" y="193.9922"/></g><g><title>DbContext</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="880.9824" y="223.125"/></g><g><title>GraphGenerator</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="999.3799" y="323.5234"/></g><g><title>QuestPDF</title><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1114.6807" y="381.7891"/></g><g class="message" data-participant-1="U" data-participant-2="Ctrl"><polygon fill="#181818" points="311.7075,160.8594,321.7075,164.8594,311.7075,168.8594,315.7075,164.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="34.6021" x2="317.7075" y1="164.8594" y2="164.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.1055" x="41.6021" y="144.6606">GET /Admin/Analytics/Details/{id}/Report</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.1147" x="41.6021" y="159.7935">(rango de fechas)</text></g><g class="message" data-participant-1="Ctrl" data-participant-2="PdfSvc"><polygon fill="#181818" points="582.9595,189.9922,592.9595,193.9922,582.9595,197.9922,586.9595,193.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="333.7075" x2="588.9595" y1="193.9922" y2="193.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.252" x="340.7075" y="188.9263">GeneratePlantReportAsync(id, dates)</text></g><g class="message" data-participant-1="PdfSvc" data-participant-2="DB"><polygon fill="#181818" points="868.9824,219.125,878.9824,223.125,868.9824,227.125,872.9824,223.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="604.9595" x2="874.9824" y1="223.125" y2="223.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.0229" x="611.9595" y="218.0591">Consultar datos (an치lisis, estados, etc.)</text></g><g class="message" data-participant-1="DB" data-participant-2="PdfSvc"><polygon fill="#181818" points="615.9595,248.2578,605.9595,252.2578,615.9595,256.2578,611.9595,252.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="609.9595" x2="884.9824" y1="252.2578" y2="252.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.915" x="621.9595" y="247.1919">Datos del reporte</text></g><g class="message" data-participant-1="PdfSvc" data-participant-2="PdfSvc"><line style="stroke:#181818;stroke-width:1;" x1="604.9595" x2="646.9595" y1="281.3906" y2="281.3906"/><line style="stroke:#181818;stroke-width:1;" x1="646.9595" x2="646.9595" y1="281.3906" y2="294.3906"/><line style="stroke:#181818;stroke-width:1;" x1="605.9595" x2="646.9595" y1="294.3906" y2="294.3906"/><polygon fill="#181818" points="615.9595,290.3906,605.9595,294.3906,615.9595,298.3906,611.9595,294.3906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.9199" x="611.9595" y="276.3247">Agregar datos a PlantReportModel</text></g><g class="message" data-participant-1="PdfSvc" data-participant-2="GraphGen"><polygon fill="#181818" points="987.3799,319.5234,997.3799,323.5234,987.3799,327.5234,991.3799,323.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="604.9595" x2="993.3799" y1="323.5234" y2="323.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.4858" x="611.9595" y="318.4575">CreateCwsiChart(datos)</text></g><g class="message" data-participant-1="GraphGen" data-participant-2="PdfSvc"><polygon fill="#181818" points="615.9595,348.6563,605.9595,352.6563,615.9595,356.6563,611.9595,352.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="609.9595" x2="1003.3799" y1="352.6563" y2="352.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.7021" x="621.9595" y="347.5903">Imagen PNG del gr치fico</text></g><g class="message" data-participant-1="PdfSvc" data-participant-2="QuestPdf"><polygon fill="#181818" points="1102.6807,377.7891,1112.6807,381.7891,1102.6807,385.7891,1106.6807,381.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="604.9595" x2="1108.6807" y1="381.7891" y2="381.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.4053" x="611.9595" y="376.7231">new PlantReportDocument(model)</text></g><g class="message" data-participant-1="PdfSvc" data-participant-2="QuestPdf"><polygon fill="#181818" points="1102.6807,406.9219,1112.6807,410.9219,1102.6807,414.9219,1106.6807,410.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="604.9595" x2="1108.6807" y1="410.9219" y2="410.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.5269" x="611.9595" y="405.856">GeneratePdf()</text></g><g class="message" data-participant-1="QuestPdf" data-participant-2="PdfSvc"><polygon fill="#181818" points="615.9595,436.0547,605.9595,440.0547,615.9595,444.0547,611.9595,440.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="609.9595" x2="1118.6807" y1="440.0547" y2="440.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.7266" x="621.9595" y="434.9888">byte[] del archivo PDF</text></g><g class="message" data-participant-1="PdfSvc" data-participant-2="Ctrl"><polygon fill="#181818" points="344.7075,465.1875,334.7075,469.1875,344.7075,473.1875,340.7075,469.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="338.7075" x2="598.9595" y1="469.1875" y2="469.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.7266" x="350.7075" y="464.1216">byte[] del archivo PDF</text></g><g class="message" data-participant-1="Ctrl" data-participant-2="U"><polygon fill="#181818" points="45.6021,494.3203,35.6021,498.3203,45.6021,502.3203,41.6021,498.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="39.6021" x2="327.7075" y1="498.3203" y2="498.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.9692" x="51.6021" y="493.2544">FileResult (descarga del archivo PDF)</text></g><!--SRC=[XLDBRjim4Dth58EiP229DaKNMXImhSJ8eeMRrAisYmavabdGf45IJesYXyaPUWHVhFnO2jKMo4RYvysRDs-6JZX9yFxwNGstil-kWHEiI9519aw_LTZUqruRHnRMpMrH87FQmCRsQ8G6jB0fzcYSO6AFoi75NA4y-grTQkMCbfBCHO0jdP5JvDsQjocLPtmWSn2C8jIVFnpO5Dmy1JxwuIAYMKnlLmRtsv4hGeQZAV1pJzRvEY8aRNXR51ku-X0Lrh2w-GBLdE-4giPIgeOS2cchduB_gf8VtrHfK7NHi9RO5kqiU2CEw2WL6pw1DvLJdsrrj9PUIYAPswDYfU2NmFr5pd3s8Fq2IxEemLjWU-dG1BYsKA8wlKXXXRq4Nmfo7HQENMT4tgfc0LUPZYR6Sf9WKcSBJZdyDUSGCUyCTMDMXAo2ZzeJPI63xLwi8K-uVBPYkVKjA6Dm9cniqB2OYBpROUUFrfzMKMbdJY-jO3gNEXAyPXywMeEYvrncerc_8-NANT2RgHXdu7yaOyTuMywAuNoYy-dewEjZr8Y6RSL1nsUIoVmdmpXgRyUUfo1Dae_R-5Sg9DrJ60CeELc6fiE_AMOvHmZ-0m00]--></g></svg>